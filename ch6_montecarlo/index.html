
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="https://sunycosmo.github.io/compphysics-course/ch6_montecarlo/" rel="canonical"/>
<link href="../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.3.1, mkdocs-material-8.4.2" name="generator"/>
<title>Monte Carlo Methods - PHY 315 Introduction to Computational Methods in Physics</title>
<link href="../assets/stylesheets/main.69437709.min.css" rel="stylesheet"/>
<link href="../assets/stylesheets/palette.cbb835fc.min.css" rel="stylesheet"/>
<meta content="#009485" name="theme-color"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body data-md-color-accent="" data-md-color-primary="teal" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#monte-carlo-methods">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="PHY 315 Introduction to Computational Methods in Physics" class="md-header__button md-logo" data-md-component="logo" href=".." title="PHY 315 Introduction to Computational Methods in Physics">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            PHY 315 Introduction to Computational Methods in Physics
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Monte Carlo Methods
            
          </span>
</div>
</div>
</div>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="PHY 315 Introduction to Computational Methods in Physics" class="md-nav__button md-logo" data-md-component="logo" href=".." title="PHY 315 Introduction to Computational Methods in Physics">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"></path></svg>
</a>
    PHY 315 Introduction to Computational Methods in Physics
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="..">
        Home
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../ch1_intro/">
        Introduction
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../ch2_symbolic/">
        Symbolic and Plotting Tools
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../ch3_numeric/">
        Numerical Methods
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../ch4_fitting/">
        Curve Fitting and Optimization
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../ch5_fouriertransform/">
        Fourier Transform
      </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
          Monte Carlo Methods
          <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
        Monte Carlo Methods
      </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#random-numbers">
    Random numbers
  </a>
<nav aria-label="Random numbers" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#estimating-area-using-random-numbers">
    Estimating area using random numbers
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#monte-carlo-integration">
    Monte Carlo Integration
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#markov-chain-monte-carlo-mcmc">
    Markov Chain Monte Carlo (MCMC)
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#examples">
    Examples
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../ch7_mltools/">
        Machine Learning Example
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../references/">
        Further References
      </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#random-numbers">
    Random numbers
  </a>
<nav aria-label="Random numbers" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#estimating-area-using-random-numbers">
    Estimating area using random numbers
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#monte-carlo-integration">
    Monte Carlo Integration
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#markov-chain-monte-carlo-mcmc">
    Markov Chain Monte Carlo (MCMC)
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#examples">
    Examples
  </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="monte-carlo-methods"><span class="enumerate-headings-plugin enumerate-heading-plugin">6.</span> Monte Carlo Methods</h1>
<h2 id="random-numbers"><span class="enumerate-headings-plugin enumerate-heading-plugin">6.1</span> Random numbers</h2>
<p>Consider the output of the following code:
<div class="highlight"><span class="filename">random module</span><pre><span></span><code><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="kn">import</span> <span class="nn">random</span>            
<a href="#__codelineno-0-2" id="__codelineno-0-2" name="__codelineno-0-2"></a>
<a href="#__codelineno-0-3" id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>        
<a href="#__codelineno-0-4" id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="nb">print</span> <span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(),</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">())</span>
</code></pre></div></p>
<p>The output will be two numbers printed on the screen. The <a href="https://docs.python.org/3/library/random.html"><code>random.random()</code></a> command gives you a random number in the range <code>[0.0, 1.0)</code>. The likelihood of getting a particular value between <code>0</code> and <code>1</code> is the same. In statistical language, such a likelihood/probability is called a uniform distribution. If you want to get a random number in a different range, say <code>[a, b]</code>, you can either use the result of <code class="highlight"><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span></code> and rescale it appropriately, or directly use the function <code class="highlight"><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span></code>.</p>
<p><strong>Use of <code class="highlight"><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">()</span></code></strong>: If you use the same <code>seed</code> number (argument) in calling <code class="highlight"><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span></code> before calling <code class="highlight"><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span></code>, the output is identical for the same <code>seed</code>. Because the returned random numbers depend on the <code>seed</code>, the number generator used by the <code>random</code> module is called a <em>pseudo-</em>random number generator. Such a generator is useful if you have to reproduce results (e.g. simulation) at a later time. If you do not provide an argument to <code>random.seed</code> or set <code>random.seed(None)</code>, the current system time is used as a proxy to a random seed and you will get different results each time you call <code>random.random()</code>.</p>
<h3 id="estimating-area-using-random-numbers"><span class="enumerate-headings-plugin enumerate-heading-plugin">6.1.1</span> Estimating area using random numbers</h3>
<p>We can make use of random numbers to estimate areas. Suppose we want to estimate the area of the unit circle. </p>
<details class="note">
<summary>Area of a unit circle</summary>
<div class="arithmatex">\[ A = \pi r ^2 = \pi (1)^2 = \pi \]</div>
</details>
<p>In this case, we know the answer is <span class="arithmatex">\(\pi\)</span>. Therefore, we can frame this exercise as a method to estimate the numerical value of <span class="arithmatex">\(\pi\)</span> as well.</p>
<p>Consider a unit circle embedded in a square. Now, in each step, we will generate two random numbers <span class="arithmatex">\((x, y)\)</span> inside the embedding square, and check whether this randomly generated point lies inside of the unit circle or outside.</p>
<p>Then an estimate of the area of the unit circle can be made:</p>
<div class="arithmatex">\[ A = \left( \frac{\rm points\ inside\ the\ circle}{\rm total\ points} \right) \times {\rm area\ of\ embedding\ square}\]</div>
<table>
<tr>
<th>
<canvas <="" canvas="" height="300" id="canvas1" width="300">
</canvas></th>
<th>
<br/><br/><br/>
<input ,="" id="NP" max="20000" min="100" onmouseup="calcpi()" step="100" type="range" value="1000"/>
<p>Total Points: <label id="label2">0</label></p>
<p>Points Inside: <label id="label1">0</label> </p>
<p>Area Estimate: <label id="Aest"></label> </p>
<hr/>
Refresh the page to estimate using a new set of random points.
</th>
</tr>
</table>
<script>
    var canvas = document.getElementById('canvas1')
    var NN = document.getElementById('NP')

    if (canvas.getContext) {
            var ctx = canvas.getContext('2d');
    }

    function randomPoint() {

        x = Math.random()*200+50;
        y = Math.random()*200+50;

        if ((x-150)*(x-150)+(y-150)*(y-150)<=10000) {
            pts = pts + 1;
            ctx.fillStyle="green";
        } else {
            ctx.fillStyle="blue";
        }

        total = total + 1;  

        ctx.fillRect(x, y, 1, 1);
        document.getElementById('label1').innerHTML = pts;
        document.getElementById('label2').innerHTML = total;

        Area = 4*pts/total
        document.getElementById('Aest').innerHTML = Area;

    }

    function calcpi() {
        ctx.clearRect(0, 0, 300, 300);

        ctx.beginPath();
        ctx.strokeStyle="blue";
        ctx.rect(50, 50, 200, 200);
        ctx.stroke();

        ctx.beginPath();
        ctx.strokeStyle="red";
        ctx.arc(150, 150, 100, 2*Math.PI, false);
        ctx.stroke();

        pts = 0;
        total = 0;

        for (let i = 0; i < NN.value; i++) {
        randomPoint();   ctx.stroke();                  
        }
    }

    calcpi();
</script>
<div class="admonition note">
<p class="admonition-title">Python code to estimate <span class="arithmatex">\(\pi\)</span></p>
<div class="highlight"><span class="filename">Estimate area of a unit circle</span><pre><span></span><code><a href="#__codelineno-1-1" id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="k">def</span> <span class="nf">pi_estimate</span><span class="p">(</span><span class="n">total</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
<a href="#__codelineno-1-2" id="__codelineno-1-2" name="__codelineno-1-2"></a>    <span class="n">pts_in</span> <span class="o">=</span> <span class="mi">0</span>
<a href="#__codelineno-1-3" id="__codelineno-1-3" name="__codelineno-1-3"></a>
<a href="#__codelineno-1-4" id="__codelineno-1-4" name="__codelineno-1-4"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">total</span><span class="p">):</span>
<a href="#__codelineno-1-5" id="__codelineno-1-5" name="__codelineno-1-5"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-1-6" id="__codelineno-1-6" name="__codelineno-1-6"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a href="#__codelineno-1-7" id="__codelineno-1-7" name="__codelineno-1-7"></a>
<a href="#__codelineno-1-8" id="__codelineno-1-8" name="__codelineno-1-8"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mf">2.0</span><span class="o">+</span><span class="n">y</span><span class="o">**</span><span class="mf">2.0</span> <span class="o">&lt;=</span> <span class="mf">1.0</span><span class="p">):</span>
<a href="#__codelineno-1-9" id="__codelineno-1-9" name="__codelineno-1-9"></a>            <span class="n">pts_in</span> <span class="o">=</span> <span class="n">pts_in</span> <span class="o">+</span> <span class="mf">1.0</span>
<a href="#__codelineno-1-10" id="__codelineno-1-10" name="__codelineno-1-10"></a>
<a href="#__codelineno-1-11" id="__codelineno-1-11" name="__codelineno-1-11"></a>    <span class="k">return</span> <span class="mf">4.0</span><span class="o">*</span><span class="n">pts_in</span><span class="o">/</span><span class="n">total</span>
<a href="#__codelineno-1-12" id="__codelineno-1-12" name="__codelineno-1-12"></a>
<a href="#__codelineno-1-13" id="__codelineno-1-13" name="__codelineno-1-13"></a><span class="nb">print</span> <span class="p">(</span><span class="n">pi_estimate</span><span class="p">())</span>
</code></pre></div>
<p>Increasing the number of points used through the <code>total</code> argument in the <code>pi_estimate</code> function improves the estimate. If <span class="arithmatex">\(N\)</span> is the number of points used, the standard error scales as <span class="arithmatex">\(1/\sqrt{N}\)</span>.</p>
</div>
<h2 id="monte-carlo-integration"><span class="enumerate-headings-plugin enumerate-heading-plugin">6.2</span> Monte Carlo Integration</h2>
<h2 id="markov-chain-monte-carlo-mcmc"><span class="enumerate-headings-plugin enumerate-heading-plugin">6.3</span> Markov Chain Monte Carlo (MCMC)</h2>
<h2 id="examples"><span class="enumerate-headings-plugin enumerate-heading-plugin">6.4</span> Examples</h2>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<nav aria-label="Footer" class="md-footer__inner md-grid">
<a aria-label="Previous: Fourier Transform" class="md-footer__link md-footer__link--prev" href="../ch5_fouriertransform/" rel="prev">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</div>
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Previous
              </span>
              Fourier Transform
            </div>
</div>
</a>
<a aria-label="Next: Machine Learning Example" class="md-footer__link md-footer__link--next" href="../ch7_mltools/" rel="next">
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Next
              </span>
              Machine Learning Example
            </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "..", "features": ["content.code.annotate"], "search": "../assets/javascripts/workers/search.ecf98df9.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
<script src="../assets/javascripts/bundle.9c69f0bc.min.js"></script>
<script src="../javascripts/mathjax.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script src="https://cdn.jsdelivr.net/npm/p5@1.4.1/lib/p5.js"></script>
</body>
</html>